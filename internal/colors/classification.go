package colors

import (
	"image/color"

	"github.com/mattn/go-ciede2000"
)

type ColorSet struct {
	Name   string
	Colors []color.RGBA
}

var colorSets = []ColorSet{
	{
		Name: "red",
		Colors: []color.RGBA{
			{255, 0, 0, 255},
			{220, 0, 0, 255},
			{180, 0, 0, 255},
			{255, 100, 100, 255},
			{255, 50, 50, 255},
			{255, 150, 150, 255},
			{255, 200, 200, 255},
			{160, 0, 0, 255},
			{140, 0, 0, 255},
			{120, 0, 0, 255},
			{200, 50, 50, 255},
			{240, 0, 0, 255},
		},
	},
	{
		Name: "green",
		Colors: []color.RGBA{
			{0, 255, 0, 255},
			{0, 150, 0, 255},
			{0, 200, 0, 255},
			{100, 255, 100, 255},
			{50, 255, 50, 255},
			{150, 255, 150, 255},
			{200, 255, 200, 255},
			{0, 160, 0, 255},
			{0, 140, 0, 255},
			{0, 120, 0, 255},
			{50, 200, 50, 255},
			{0, 240, 0, 255},
		},
	},
	{
		Name: "blue",
		Colors: []color.RGBA{
			{0, 0, 255, 255},
			{0, 255, 255, 255},
			{0, 0, 200, 255},
			{100, 100, 255, 255},
			{50, 50, 255, 255},
			{150, 150, 255, 255},
			{200, 200, 255, 255},
			{0, 0, 160, 255},
			{0, 0, 140, 255},
			{0, 0, 120, 255},
			{50, 50, 200, 255},
			{0, 0, 240, 255},
		},
	},
	{
		Name: "yellow",
		Colors: []color.RGBA{
			{255, 255, 0, 255},
			{230, 230, 0, 255},
			{200, 200, 0, 255},
			{255, 255, 100, 255},
			{255, 255, 50, 255},
			{255, 255, 150, 255},
			{255, 255, 200, 255},
			{210, 210, 0, 255},
			{180, 180, 0, 255},
			{150, 150, 0, 255},
			{220, 220, 0, 255},
			{250, 250, 0, 255},
		},
	},
	{
		Name: "bw",
		Colors: []color.RGBA{
			{255, 255, 255, 255},
			{0, 0, 0, 255},
			{200, 200, 200, 255},
			{100, 100, 100, 255},
			{150, 150, 150, 255},
			{50, 50, 50, 255},
			{80, 80, 80, 255},
			{30, 30, 30, 255},
			{180, 180, 180, 255},
			{130, 130, 130, 255},
			{80, 80, 80, 255},
			{120, 120, 120, 255},
			{160, 160, 160, 255},
		},
	},
}

func ClassifyColor(inputColor color.RGBA) string {
	closest := "bw"
	diff := ciede2000.Diff(inputColor, colorSets[4].Colors[0])

	for _, colorSet := range colorSets {
		for _, currColor := range colorSet.Colors {
			currDiff := ciede2000.Diff(currColor, inputColor)
			if currDiff < diff {
				closest = colorSet.Name
				diff = currDiff
			}
		}
	}

	return closest
}
